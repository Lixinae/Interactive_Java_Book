<html>
 <head>
  <script src="asset/jquery-2.1.4.js"></script>
  <script>
  
		function sendAnswer(id){
			var element = $("#exercice");
			var answerToSend = $("#answer");
			$.post('/validateExercice/'+id+'/'+answerToSend.val(),
					function(data){
						console.log(data);
						element.append(data);
					}
				);
		}

		function printExercice(id){
			var element = $("#exercice");
			var respon = $("#respons");
			var sendB = $("#sendButton");

			var noData = '<p>There is no Exercice '+id+'.MARKDOWN</p>' ;
			element.html("");
			$.get('/exercice/'+id+'.MARKDOWN',
				function(data){
					console.log(data);
					element.append(data);
					if(data.localeCompare(noData) == 0){
						respon.html("");
						sendB.html("");
					}
				}
			);
		}
		
		function printAnswerArea(){
			var respon = $("#respons");
			respon.html("");
			respon.append('<textarea id=\"answer\" rows=10 cols=50 >Your answser !</textarea>');
		}
		
		function printAnswerButton(id){
			var sendB = $("#sendButton");
			
			sendB.html("");
			sendB.append('<input id=Send_answer type=button value=Send_answer onclick=sendAnswer('+id+');'+' </input>');
		}
		
		// TODO 
		// Resoudre probleme clignotement au moment de l'actualisation des buttons
		function printButtons(){
			var buttons = $("#buttons");
			buttons.html("");
			$.get('/countfiles',
				function(data){
					for(i=0 ;i< parseInt(data);i++){
						buttons.append('<input id=button'+i+' type=button '+' value=Exercice_'+i+' onclick=printExercice('+i+');printAnswerArea();printAnswerButton('+i+');'+' </input>');
					}
				}
			);		
		}
		
		//function testModify(){
		//	$.get('/watcherModify',function(data){
		//
		//	}
		//}
		
		$(document).ready(function(){
			printButtons();
			//testModify();
			var interval = 1000 * 60 * 1;
			setInterval(printButtons,interval);
		});

		
  </script>
 </head>
 <body>
	<div id="buttons">

	</div>
	<div id="exercice">
		
	</div>
	<div id="respons">
		
	</div>
	<div id="sendButton">

	</div>
 </body>
</html>
